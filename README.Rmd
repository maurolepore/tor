---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# readwith

[![lifecycle](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Travis build status](https://travis-ci.org/maurolepore/readwith.svg?branch=master)](https://travis-ci.org/maurolepore/readwith)
[![Coverage status](https://coveralls.io/repos/github/maurolepore/readwith/badge.svg)](https://coveralls.io/r/maurolepore/readwith?branch=master)
[![CRAN status](https://www.r-pkg.org/badges/version/readwith)](https://cran.r-project.org/package=readwith)

The goal of __readwith__ is to read multiple files at once with any reading function. It is simple, flexible, and fits well in data-science workflows with the tidyverse. It is easy to extend because it is focused and small (it depends only on [__fs__](https://fs.r-lib.org/) and [__rlang__](https://rlang.r-lib.org/)).

## Installation

``` r
# install.packages("devtools")
devtools::install_github("maurolepore/readwith")
```

## Example

```{r}
library(magrittr)
library(readwith)

```

All functions input a path and output a list.

#### `<input>_list`

The simplest, less flexible functions are prefixed after the file format they read. The argument `path` always defaults to the working directory.

```{r}
dir()

csv_list()
```

Commonly you would specify a `path`.

```{r}
# Helps create paths to examples
readwith_example()

(path_rds <- readwith_example("rds"))
dir(path_rds)

rds_list(path_rds)

(path_tsv <- readwith_example("tsv"))
dir(path_tsv)

tsv_list(path_tsv)

path_mixed <- readwith_example("mixed")
dir(path_mixed)

csv_list(path_mixed)

rdata_list(path_mixed)
```

### `read_with()`

`read_with()` is flexible. The reading function is not determined -- you provide it.

```{r}
(path_csv <- readwith_example("csv"))
dir(path_csv)

read_with(path_csv, read.csv)
```

`read_with()` understands both regular functions and formulas (powered by [__rlang__](https://rlang.r-lib.org/)).

```{r}
(path_rdata <- readwith_example("rdata"))
dir(path_rdata)

path_rdata %>% 
  read_with(function(x) get(load(x)))

# Same
path_rdata %>% 
  read_with(~get(load(.x)))
```

You can pass additional arguments via `...` or inside the lambda function (e.g. as `lapply()` and `purrr::map()`).

```{r}
read_with(path_csv, read.csv, stringsAsFactors = FALSE)

read_with(path_csv, ~read.csv(., stringsAsFactors = FALSE))
```

For additional flexibility you can use `regexp`, `ignore.case`, and `invert` to pick specific files in a directory (powered by [__fs__](https://fs.r-lib.org/)).

```{r}
path_mixed <- readwith_example("mixed")
dir(path_mixed)

path_mixed %>% 
  read_with(~get(load(.)), "[.]Rdata$", ignore.case = TRUE)

path_mixed %>% 
  read_with(~get(load(.)), regexp = "[.]csv$", invert = TRUE)
```

# Related projects

There are great packages to read and write data, such as [__rio__](https://CRAN.R-project.org/package=rio) and [__io__](https://CRAN.R-project.org/package=io). __readwith__ does less than most alternatives, yet it is generally more flexible and smaller.


---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# tor

[![lifecycle](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Travis build status](https://travis-ci.org/maurolepore/tor.svg?branch=master)](https://travis-ci.org/maurolepore/tor)
[![Coverage status](https://coveralls.io/repos/github/maurolepore/tor/badge.svg)](https://coveralls.io/r/maurolepore/tor?branch=master)
[![CRAN status](https://www.r-pkg.org/badges/version/tor)](https://cran.r-project.org/package=tor)

The goal of __tor__ is to read multiple files at once with any reading function. It is simple, flexible, and fits well in data-science workflows with the tidyverse. It is easy to extend because it is focused and small (it depends only on [__fs__](https://fs.r-lib.org/) and [__rlang__](https://rlang.r-lib.org/)).

## Installation

``` r
# install.packages("devtools")
devtools::install_github("maurolepore/tor")
```

## Example

```{r}
library(magrittr)
library(tor)

```

All functions input a path and output a list.

#### `<input>_list

The simplest, less flexible functions are prefixed after the file format they read. The argument `path` always defaults to the working directory.

```{r}
dir()

csv_list()
```

But often you will specify a `path`.

```{r}
# Helpes create paths to examples
tor_example()

(path_rds <- tor_example("rds"))
dir(path_rds)

rds_list(path_rds)

(path_tsv <- tor_example("tsv"))
dir(path_tsv)

tsv_list(path_tsv)

path_mixed <- tor_example("mixed")
dir(path_mixed)

csv_list(path_mixed)

rdata_list(path_mixed)
```

### `read_with()`

`read_with()` is the most flexible. You supply the function to read with.

```{r}
(path_csv <- tor_example("csv"))
dir(path_csv)

read_with(path_csv, read.csv)
```

It understands lambda functions and formulas (powered by [__rlang__](https://rlang.r-lib.org/)).

```{r}
(path_rdata <- tor_example("rdata"))
dir(path_rdata)

path_rdata %>% 
  read_with(function(x) get(load(x)))

# Same
path_rdata %>% 
  read_with(~get(load(.x)))
```

Pass additional arguments via `...` or inside the lambda function (as `lapply()`).

```{r}
read_with(path_csv, read.csv, stringsAsFactors = FALSE)

read_with(path_csv, ~read.csv(., stringsAsFactors = FALSE))
```

Use `regexp`, `ignore.case`, and `invert` to pick specific files in a directory (powered by [__fs__](https://fs.r-lib.org/)).

```{r}
path_mixed <- tor_example("mixed")
dir(path_mixed)

path_mixed %>% 
  read_with(~get(load(.)), "[.]Rdata$", ignore.case = TRUE)

path_mixed %>% 
  read_with(~get(load(.)), regexp = "[.]csv$", invert = TRUE)
```

# Related projects

There are great packages to read and write data, for example [__rio__](https://CRAN.R-project.org/package=rio) and [__io__](https://CRAN.R-project.org/package=io). __tor__ does less than the alternatives, yet it is more flexible and small.

